# **README: –£—Ç–∏–ª–∏—Ç–∞ –æ—á–∏—Å—Ç–∫–∏ –∫—ç—à–∞ 1–°:–ü—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–µ (v2.0)**

## **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**
–°–∫—Ä–∏–ø—Ç PowerShell –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è –∫—ç—à-–¥–∞–Ω–Ω—ã—Ö 1–°:–ü—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–µ 8.x. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç:
- –õ–æ–∫–∞–ª—å–Ω—É—é –æ—á–∏—Å—Ç–∫—É –Ω–∞ —Ç–µ–∫—É—â–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ
- –£–¥–∞–ª–µ–Ω–Ω—É—é –æ—á–∏—Å—Ç–∫—É —á–µ—Ä–µ–∑ 3 –º–µ—Ç–æ–¥–∞ (–∞–¥–º–∏–Ω. —à–∞—Ä—É, WMI –∏ PowerShell Remoting)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∂–∏–º –¥–ª—è –ø–∞–∫–µ—Ç–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

## **üõ† –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**
- –£–¥–∞–ª–µ–Ω–∏–µ –∫—ç—à-–ø–∞–ø–æ–∫ 1–° –ø–æ —à–∞–±–ª–æ–Ω—É GUID
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ 1–° –ø–µ—Ä–µ–¥ –æ—á–∏—Å—Ç–∫–æ–π
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–∞–∫ –ª–æ–∫–∞–ª—å–Ω—ã—Ö, —Ç–∞–∫ –∏ —Å–µ—Ç–µ–≤—ã—Ö –ø—Ä–æ—Ñ–∏–ª–µ–π
- –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Å–∏—Å—Ç–µ–º–Ω—É—é –ø–∞–ø–∫—É TEMP
- –ó–∞–ø–∏—Å—å —É—Å–ø–µ—à–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –≤ Windows Event Log
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∂–∏–º –±–µ–∑ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –º–µ–Ω—é

## **‚öôÔ∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è**
- PowerShell 5.1 –∏–ª–∏ –Ω–æ–≤–µ–µ
- –ü—Ä–∞–≤–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- –î–ª—è —É–¥–∞–ª–µ–Ω–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏:
  - –î–æ—Å—Ç—É–ø –∫ WMI (–ø–æ—Ä—Ç 135) **–∏–ª–∏**
  - –î–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–º —Ä–µ—Å—É—Ä—Å–∞–º (C$) **–∏–ª–∏**
  - –†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–π PowerShell Remoting

–í–æ—Ç –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–¥–µ–ª "–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é" —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∑–∞–ø—É—Å–∫–∞:

## **üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é**

### **1. –ë–∞–∑–æ–≤—ã–π –∑–∞–ø—É—Å–∫**
```powershell
powershell.exe -ExecutionPolicy Bypass -File "clear_1C_cash.ps1"
```

### **2. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—É—Å–∫–∞**
| –ü–∞—Ä–∞–º–µ—Ç—Ä          | –û–ø–∏—Å–∞–Ω–∏–µ                                                                 | –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è                          |
|--------------------|--------------------------------------------------------------------------|-----------------------------------------------|
| `-ComputerName`    | –û—á–∏—Å—Ç–∫–∞ –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ (–∏–º—è –∏–ª–∏ IP-–∞–¥—Ä–µ—Å)                      | `.\clear_1C_cash.ps1 -ComputerName SRV-1C-01` |
| `-AutoMode`        | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∂–∏–º (–±–µ–∑ –º–µ–Ω—é –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π)                          | `.\clear_1C_cash.ps1 -AutoMode`               |
| `-Force` –∏–ª–∏ `-Y`  | –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞, –¥–∞–∂–µ –µ—Å–ª–∏ –∑–∞–ø—É—â–µ–Ω—ã –ø—Ä–æ—Ü–µ—Å—Å—ã 1–°                   | `.\clear_1C_cash.ps1 -Force`                  |
| `-LogPath`         | –£–∫–∞–∑–∞–Ω–∏–µ —Å–≤–æ–µ–≥–æ –ø—É—Ç–∏ –¥–ª—è –ª–æ–≥–æ–≤                                          | `.\clear_1C_cash.ps1 -LogPath "C:\logs\clean.log"` |

### **3. –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**

# –õ–æ–∫–∞–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º
`.\clear_1C_cash.ps1`

# –£–¥–∞–ª–µ–Ω–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–º —Ä–µ–∂–∏–º–µ
`.\clear_1C_cash.ps1 -ComputerName SRV-1C-01 -AutoMode`

# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ (–∏–≥–Ω–æ—Ä–∏—Ä—É—è –∑–∞–ø—É—â–µ–Ω–Ω—ã–µ 1–°)
`.\clear_1C_cash.ps1 -Force`

# –û—á–∏—Å—Ç–∫–∞ —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º –ø—É—Ç–µ–º –ª–æ–≥–æ–≤
`.\clear_1C_cash.ps1 -ComputerName SRV-1C-01 -LogPath "C:\audit\1c_clean.log"`


### **üìå –í–∞–∂–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**
1. **–ú–µ—Ç–æ–¥—ã –æ—á–∏—Å—Ç–∫–∏** (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫):
   - –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è —à–∞—Ä–∞ (`\\comp\c$\Users`)
   - WMI (Win32_UserProfile)
   - PowerShell Remoting (PSRP)

2. **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è —É–¥–∞–ª–µ–Ω–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏**:
   - –ü—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –Ω–∞ —Ü–µ–ª–µ–≤–æ–º –ü–ö
   - –î–æ—Å—Ç—É–ø —Ö–æ—Ç—è –±—ã –∫ –æ–¥–Ω–æ–º—É –º–µ—Ç–æ–¥—É:
     - –û–±—â–∏–π –¥–æ—Å—Ç—É–ø C$
     - WMI (–ø–æ—Ä—Ç 135)
     - –†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–π PowerShell Remoting

3. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**:
   - –ù–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏ (`systemprofile`, `service` –∏ –¥—Ä.)
   - –í –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–º —Ä–µ–∂–∏–º–µ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ

4. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**:
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–æ—Ç–∞—Ü–∏—è –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ 1 –ú–ë
   - –ü—É—Ç—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `%TEMP%\clear_1c_cache.log`
   - –£—Å–ø–µ—à–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ WMI —Ñ–∏–∫—Å–∏—Ä—É—é—Ç—Å—è –≤ Event Log




## **‚öôÔ∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏**
–û—á–∏—â–∞–µ–º—ã–µ –ø–∞–ø–∫–∏:
```
%USERPROFILE%\AppData\Local\1C\1Cv8
%USERPROFILE%\AppData\Roaming\1C\1Cv8
```
**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É–¥–∞–ª–µ–Ω–∏—è**: –ø–∞–ø–∫–∏ —Å –∏–º–µ–Ω–µ–º –≤ —Ñ–æ—Ä–º–∞—Ç–µ GUID (–Ω–∞–ø—Ä–∏–º–µ—Ä: `f71c41ae-1c4b-4a9b-9c6d-3f7a8b9c0d1e`)

## **‚ö†Ô∏è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**
1. –ü–µ—Ä–µ–¥ –º–∞—Å—Å–æ–≤–æ–π –æ—á–∏—Å—Ç–∫–æ–π:
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –º–µ—Ç–æ–¥–æ–≤ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º –ü–ö
   ```powershell
   Test-AdminShare -Computer SERVER01
   Test-WMI -Computer SERVER01
   Test-PSRemoting -Computer SERVER01
   ```
2. –î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏:
   ```powershell
   # –û—á–∏—Å—Ç–∫–∞ —Å–ø–∏—Å–∫–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤
   "SRV-1C-01", "SRV-1C-02" | ForEach-Object {
       .\clear_1C_cash.ps1 -ComputerName $_ -AutoMode
   }
   ```

## **üîÑ –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å**
–°–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –Ω–∞–ø—Ä–∞–≤–ª—è–π—Ç–µ –≤ [Issues](https://github.com/username/repo/issues)

---

Copyright ¬© 2025 –ö–æ–¥–µ–ª—å–Ω–∏–∫ –ú–∞–∫—Å–∏–º –°–µ—Ä–≥–µ–µ–≤–∏—á | MIT License  
–í–µ—Ä—Å–∏—è: 2.0 (2025-07-24)
